# Flow
## Step A.
get to the authentication page
- server configuration
	- authorization endpoint
		- `https://oauth.boruta.patatoid.fr/.well-known/openid-configuration`
		- by default issuer + "/oauth/authorize"
	- client identifier accessible in the client view
		- client id in the list and details
	- requested scope
		- about scope creation
			- depper understanding in scope page
		- scope access (client, backend, and user levels)
	- local state
		- a random string generated by the client
		- will be replied back to ensure the same client is originating the request
	- redirection URI
		- "add a redirect URI" in the client view
		- the client can only use registered redirect URIs
		- the redirection is made to the client application (a server)
	- resulting request from the user-agent to the authorization endpoint
- result of the step
	- perform the request
```
GET <issuer>/oauth/authorize?client_id=<client id>&scope=<scope>&state=<state>&redirect_uri=<redirect uri>&response_type=code`
```
## Step B.
user authenticates
- server configuration (authentication)
	- templates
		- edit layout template
		- edit login template
	- MFA with TOTP
	- deeper understanding in identity provider page
- result of the step
	- client authenticated
## Step C.
Callback to the client application through the user-agent of the resource owner
- server configuration
	- none
- explanations
	- authorization code
		- code that helps the client to get an access token at authorizarion code phace (D)
	- local state
		- should be the same string as in (A) to ensure the origin of the request
- result
```
302 redirected
<redirect uri>?code=<authorization code>&state=<state>
```
1. the user-agent provides the code to the client application
2. the client requests an access token
```
POST <issuer>/oauth/token

code=<code>&client_id=<client id>&redirect_uri=<redirect uri>&grant_type=authorization_code
```
## Step D.
The client requests the access token
- server configuration
	- client authentication
		- client form "Client authentication" part
		- link to the client resource @pascal write a client authentication section in it
	- validates the authorization code
		- code TTL in client form
- result
```
200 OK

Content-Type: application/json
{
	"access_token": <AT>,
	"token_type": "bearer",
	"expires_in": 3600,
	"refresh_token": <RT>
}
```
